package kr.or.dduk.nurse.service.impl;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.ResponseBody;

import kr.or.dduk.mapper.WardMapper;
import kr.or.dduk.nurse.service.WardService;
import kr.or.dduk.util.SessionInfo;
import kr.or.dduk.vo.AdmissionChartVO;
import kr.or.dduk.vo.NurChartVO;

@Service
public class WardServiceImpl implements WardService{
	
	@Autowired
	WardMapper wardMapper;
	
	@Autowired
	SessionInfo sessionInfo;
	
	/**
	 * 병동관리에서 병상 누를 때 보여줄 간단한 입원정보와 간호차트를 가져오는 메서드
	 * @param admiNo 입원번호
	 * @return AdmissionChartVO 입원VO
	 */
	@Override
	public AdmissionChartVO getNurseChartList(String admiNo) {
		return this.wardMapper.getNurseChartList(admiNo);
	}


	/**
	 * 병동관리에서 간호차트 날짜 클릭시 간호차트의 detail 출력
	 * @param nurNo 간호차트번호
	 * @return NurChartVO 간호차트VO
	 */
	@Override
	public NurChartVO getNurseChartDetail(String nurNo) {
		return this.wardMapper.getNurseChartDetail(nurNo);
	}
	
	
	/**
	 * 간호차트/인수인계 insert
	 * @param insert시킬 데이터
	 * @return 결과
	 */
	@Override
	public Map<String, Object> createNurseChart(NurChartVO nurChartVO) {
		Map<String, Object> map = new HashMap<>();
		// 현재 접속중인 사번 불러와서 작성자 사번에 넣어주기
		String empNo = sessionInfo.getEmpNo();
		nurChartVO.setNurChartEmpNo(empNo);
		int result = this.wardMapper.createNurseChart(nurChartVO);
		// 결과에 성공여부와 간호차트번호를 넣어준다
		map.put("nurNo", nurChartVO.getNurNo());
		map.put("result", result);
		return map;
	}
	
	
	/**
	 * 인수인계 리스트 뽑아오기
	 * @param admiNo 입원번호
	 * @return NurChartVOList 간호차트 리스트(인수인계만)
	 */
	public List<NurChartVO> getHandOverList(String admiNo){
		return this.wardMapper.getHandOverList(admiNo);
	}
}
